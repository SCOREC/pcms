cmake_minimum_required(VERSION 2.8)

project(hello_1)

set(CMAKE_MODULE_PATH ${CMAKE_MODULE_PATH} "${CMAKE_CURRENT_SOURCE_DIR}/../../cpl/cmake/")
set(CMAKE_MODULE_PATH ${CMAKE_MODULE_PATH} "/global/common/sw/cray/cnl7/haswell/adios2/2.4.0/intel/19.0.3.199/26fprnf/lib64/cmake/adios2")

find_package(ADIOS REQUIRED)
include_directories(${ADIOS_INCLUDE_DIRS})

set(USER_LIB_DIR "/users/adesoa/dev/install")
set(ADIOS2_INCLUDE_DIRS "${USER_LIB_DIR}/ADIOS2/include/adios2/fortran")

include_directories(${ADIOS2_INCLUDE_DIRS})

find_package(MPI)
include_directories(${MPI_INCLUDE_DIRS})

find_package(HDF5)
#include_directories(${HDF5_INCLUDE_DIRS})

#add_definitions(-DADIOS)
add_definitions(-DADIOS2)

set(LINK_LIBS ${LINK_LIBS} ${ADIOS_LIB} ${ADIOS2_LIB} ${MPI_Fortran_LIBRARIES})
set(INCLUDE_DIRS ${INCLUDE_DIRS} ${ADIOS_INCLUDE_DIRS} ${ADIOS2_INCLUDE_DIRS} ${MPI_INCLUDE_DIRS})

add_executable(app1 app1.cc)

target_include_directories(app1 PUBLIC
  $<BUILD_INTERFACE:${CMAKE_CURRENT_SOURCE_DIR}>
  $<INSTALL_INTERFACE:include>
  ${INCLUDE_DIRS}
  )

target_link_libraries(app1 ${LINK_LIBS})

install(TARGETS app1 
	RUNTIME DESTINATION bin
	LIBRARY DESTINATION ${PROJECT_BINARY_DIR} 
	ARCHIVE DESTINATION ${PROJECT_BINARY_DIR})
